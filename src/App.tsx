import { useState, useRef } from 'react';
import Tiptap from './Tiptap';
import { EnhancedTableOfContents } from './components/EnhancedTableOfContents';
import type { Editor } from '@tiptap/react';
import './App.css';

function App() {
  const [editor, setEditor] = useState<Editor | null>(null);
  const scrollContainerRef = useRef<HTMLDivElement>(null);

  const initialMarkdown = `æ¬¢è¿Žä½¿ç”¨åŠŸèƒ½ä¸°å¯Œçš„ Tiptap ç¼–è¾‘å™¨ï¼å·¦ä¾§çš„ç›®å½•ä¼šè‡ªåŠ¨æå–æ–‡æ¡£ä¸­çš„æ ‡é¢˜ï¼Œç‚¹å‡»å¯ä»¥å¿«é€Ÿè·³è½¬ã€‚

## ç¼–è¾‘å™¨åŠŸèƒ½æ¦‚è§ˆ

### åŸºç¡€æ–‡æœ¬æ ¼å¼
æ”¯æŒå¤šç§æ–‡æœ¬æ ¼å¼åŒ–é€‰é¡¹ï¼š
- **ç²—ä½“æ–‡æœ¬** - ä½¿ç”¨ **æ–‡æœ¬** æˆ– Ctrl+B
- *æ–œä½“æ–‡æœ¬* - ä½¿ç”¨ *æ–‡æœ¬* æˆ– Ctrl+I
- ~~åˆ é™¤çº¿~~ - ä½¿ç”¨ ~~æ–‡æœ¬~~
- \`è¡Œå†…ä»£ç \` - ä½¿ç”¨åå¼•å·åŒ…å›´

### åˆ—è¡¨åŠŸèƒ½
#### æ— åºåˆ—è¡¨
- ç¬¬ä¸€ä¸ªåˆ—è¡¨é¡¹
- ç¬¬äºŒä¸ªåˆ—è¡¨é¡¹
  - åµŒå¥—åˆ—è¡¨é¡¹
  - å¦ä¸€ä¸ªåµŒå¥—é¡¹
- ç¬¬ä¸‰ä¸ªåˆ—è¡¨é¡¹

#### æœ‰åºåˆ—è¡¨
1. ç¬¬ä¸€æ­¥æ“ä½œ
2. ç¬¬äºŒæ­¥æ“ä½œ
3. ç¬¬ä¸‰æ­¥æ“ä½œ

### å¼•ç”¨å’Œä»£ç 
#### å¼•ç”¨å—
> è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨å—ï¼Œå¯ä»¥ç”¨æ¥çªå‡ºæ˜¾ç¤ºé‡è¦å†…å®¹æˆ–å¼•ç”¨ä»–äººçš„è¯ã€‚
>
> æ”¯æŒå¤šè¡Œå¼•ç”¨å†…å®¹ã€‚

#### ä»£ç å—
\`\`\`javascript
// è¿™æ˜¯ä¸€ä¸ª JavaScript ä»£ç ç¤ºä¾‹
function greetUser(name) {
  return \`Hello, \${name}! Welcome to our editor.\`;
}

console.log(greetUser("Developer"));
\`\`\`

## é«˜çº§äº¤äº’åŠŸèƒ½

### æ–œæ å‘½ä»¤ç³»ç»Ÿ
åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥ \`/\` å¯ä»¥å¿«é€Ÿæ’å…¥å„ç§å†…å®¹ï¼š
- æ ‡é¢˜ï¼ˆH1-H3ï¼‰
- åˆ—è¡¨ï¼ˆæœ‰åº/æ— åºï¼‰
- å¼•ç”¨å—
- ä»£ç å—
- åˆ†å‰²çº¿

### AI è¾…åŠ©ç¼–è¾‘
#### æ‚¬æµ®å›¾æ ‡åŠŸèƒ½
- é¼ æ ‡æ‚¬æµ®åœ¨æ®µè½ä¸Šä¼šæ˜¾ç¤º "+" å›¾æ ‡
- ç‚¹å‡»å›¾æ ‡å¯ä»¥æ‰“å¼€ AI å¤„ç†é¢æ¿
- æ”¯æŒæ™ºèƒ½å†…å®¹ç”Ÿæˆå’Œä¼˜åŒ–

#### æ–‡æœ¬é€‰æ‹©å»ºè®®
- é€‰æ‹©æ–‡æœ¬åŽä¼šå‡ºçŽ° AI å»ºè®®æŒ‰é’®
- æ”¯æŒå•å…ƒç´ å’Œè·¨å…ƒç´ é€‰æ‹©
- æä¾›æ™ºèƒ½çš„å†…å®¹æ”¹è¿›å»ºè®®

### é“¾æŽ¥ç®¡ç†
#### é“¾æŽ¥æ‚¬æµ®èœå•
æ‚¬æµ®åœ¨é“¾æŽ¥ä¸Šä¼šæ˜¾ç¤ºç®¡ç†èœå•ï¼š
- æ˜¾ç¤ºå®Œæ•´ URL
- ç¼–è¾‘é“¾æŽ¥æ–‡æœ¬å’Œåœ°å€
- å¤åˆ¶é“¾æŽ¥åœ°å€
- åˆ é™¤é“¾æŽ¥

ç¤ºä¾‹é“¾æŽ¥ï¼š[è®¿é—® GitHub](https://github.com)

## ç›®å½•å¯¼èˆªåŠŸèƒ½

### å®žæ—¶ç›®å½•ç”Ÿæˆ
å·¦ä¾§çš„ç›®å½•é¢æ¿ä¼šï¼š
- è‡ªåŠ¨æå–æ–‡æ¡£ä¸­çš„æ‰€æœ‰æ ‡é¢˜
- æ˜¾ç¤ºå±‚çº§ç»“æž„
- å®žæ—¶æ›´æ–°å†…å®¹å˜åŒ–
- é«˜äº®å½“å‰ç¼–è¾‘ä½ç½®

### æœç´¢åŠŸèƒ½
- åœ¨ç›®å½•é¡¶éƒ¨çš„æœç´¢æ¡†ä¸­è¾“å…¥å…³é”®è¯
- å®žæ—¶è¿‡æ»¤åŒ¹é…çš„æ ‡é¢˜
- æ”¯æŒæ¨¡ç³Šæœç´¢

### æŠ˜å å±•å¼€
- ç‚¹å‡»æ ‡é¢˜å‰çš„ç®­å¤´å¯ä»¥æŠ˜å /å±•å¼€å­çº§
- æ”¯æŒå¤šçº§åµŒå¥—ç»“æž„
- ä¿æŒæŠ˜å çŠ¶æ€

## æŠ€æœ¯ç‰¹æ€§

### å“åº”å¼è®¾è®¡
- æ¡Œé¢ç«¯ï¼šç›®å½•å›ºå®šåœ¨å·¦ä¾§
- å¹³æ¿ç«¯ï¼šç›®å½•å®½åº¦è‡ªé€‚åº”
- ç§»åŠ¨ç«¯ï¼šç›®å½•æŠ˜å åˆ°é¡¶éƒ¨

### æ€§èƒ½ä¼˜åŒ–
- é˜²æŠ–å¤„ç†é¿å…é¢‘ç¹æ›´æ–°
- è™šæ‹Ÿæ»šåŠ¨æ”¯æŒå¤§æ–‡æ¡£
- æ™ºèƒ½ç¼“å­˜æœºåˆ¶

### æ— éšœç¢æ”¯æŒ
- é”®ç›˜å¯¼èˆªæ”¯æŒ
- å±å¹•é˜…è¯»å™¨å‹å¥½
- é«˜å¯¹æ¯”åº¦æ¨¡å¼

---

## å¼€å§‹ä½¿ç”¨

çŽ°åœ¨æ‚¨å¯ä»¥ï¼š
1. åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹
2. ä½¿ç”¨å·¦ä¾§ç›®å½•å¿«é€Ÿå¯¼èˆª
3. å°è¯•å„ç§äº¤äº’åŠŸèƒ½
4. ä½“éªŒ AI è¾…åŠ©ç¼–è¾‘

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ðŸŽ‰`;

  const handleTocItemClick = (id: string) => {
    console.log('è·³è½¬åˆ°æ ‡é¢˜ ID:', id);
  };

  return (
    <div className="App">
      <div className="app-layout">
        <EnhancedTableOfContents
          editor={editor}
          scrollContainerRef={scrollContainerRef}
          onItemClick={handleTocItemClick}
          collapsible={true}
          showNumbers={false}
          maxLevel={6}
        />

        <div className="editor-container" ref={scrollContainerRef}>
          <Tiptap
            markdown={initialMarkdown}
            onEditorReady={setEditor}
          />
        </div>
      </div>
    </div>
  );
}

export default App;
